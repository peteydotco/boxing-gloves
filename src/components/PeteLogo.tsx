import { useState, useRef } from 'react'
import { motion, useMotionValue, useSpring } from 'framer-motion'

export function PeteLogo() {
  const [isHovered, setIsHovered] = useState(false)
  const logoRef = useRef<HTMLDivElement>(null)

  // Mouse follow effect - only on exit
  const rotateX = useMotionValue(0)
  const rotateY = useMotionValue(0)
  const springRotateX = useSpring(rotateX, { stiffness: 150, damping: 12 })
  const springRotateY = useSpring(rotateY, { stiffness: 150, damping: 12 })
  const lastMousePos = useRef({ x: 0, y: 0 })

  const handleMouseMove = (e: React.MouseEvent<HTMLDivElement>) => {
    if (!logoRef.current) return
    const rect = logoRef.current.getBoundingClientRect()
    const centerX = rect.left + rect.width / 2
    const centerY = rect.top + rect.height / 2
    // Track mouse position relative to center for exit direction
    lastMousePos.current = {
      x: e.clientX - centerX,
      y: e.clientY - centerY
    }
  }

  const handleMouseLeave = () => {
    setIsHovered(false)
    if (!logoRef.current) return
    const rect = logoRef.current.getBoundingClientRect()
    // Apply magnetic follow in exit direction, then spring back
    const exitRotateX = (-lastMousePos.current.y / rect.height) * 25
    const exitRotateY = (lastMousePos.current.x / rect.width) * 25
    rotateX.set(exitRotateX)
    rotateY.set(exitRotateY)
    // Spring back to 0 after a brief moment
    setTimeout(() => {
      rotateX.set(0)
      rotateY.set(0)
    }, 100)
  }

  return (
    <motion.div
      ref={logoRef}
      onMouseEnter={() => setIsHovered(true)}
      onMouseMove={handleMouseMove}
      onMouseLeave={handleMouseLeave}
      style={{
        rotateX: springRotateX,
        rotateY: springRotateY,
        cursor: 'pointer',
      }}
      animate={{
        scale: isHovered ? 1.03 : 1,
      }}
      transition={{
        type: 'spring',
        stiffness: 200,
        damping: 15,
      }}
    >
      <svg width="124" height="42" viewBox="0 0 124 42" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M105.339 30.6015C102.711 30.6015 100.829 29.4396 99.8058 27.6966C98.7822 26.1474 98.6162 23.7404 98.6162 20.5865C98.6162 17.4326 98.7822 15.0257 99.8058 13.4764C100.829 11.7335 102.711 10.5715 105.339 10.5715C107.94 10.5715 109.821 11.7335 110.844 13.4764C111.84 15.0257 112.034 17.4326 112.034 20.5865C112.034 23.7404 111.84 26.1474 110.844 27.6966C109.821 29.4396 107.94 30.6015 105.339 30.6015ZM102.047 20.5865C102.047 22.6061 102.047 24.4597 102.517 25.4834C103.043 26.7283 104.094 27.254 105.339 27.254C106.556 27.254 107.608 26.7283 108.133 25.4834C108.604 24.4597 108.604 22.6061 108.604 20.5865C108.604 18.5669 108.604 16.7133 108.133 15.6897C107.608 14.4447 106.556 13.9191 105.339 13.9191C104.094 13.9191 103.043 14.4447 102.517 15.6897C102.047 16.7133 102.047 18.5669 102.047 20.5865Z" fill="#000000" fillOpacity="0.6"/>
        <path d="M90.4521 30.6015C87.8239 30.6015 85.9149 29.4672 84.919 27.6966C83.923 26.1474 83.7017 23.7404 83.7017 20.5865C83.7017 17.4326 83.8953 15.0257 84.919 13.4764C85.9426 11.7058 87.8239 10.5715 90.4521 10.5715C94.2423 10.5715 96.8429 12.9508 96.8429 16.824C96.8429 17.1283 96.5939 17.3773 96.2896 17.3773H93.9933C93.689 17.3773 93.4123 17.1283 93.4123 16.824C93.4123 15.164 92.3057 13.9191 90.4521 13.9191C89.2072 13.9191 88.1559 14.4447 87.6302 15.6897C87.1599 16.7133 87.1322 18.5669 87.1322 20.5865C87.1322 22.6061 87.1599 24.4597 87.6302 25.4834C88.1835 26.7007 89.2072 27.254 90.4521 27.254C92.3057 27.254 93.4123 26.0644 93.4123 24.3491C93.4123 24.0448 93.689 23.7958 93.9933 23.7958H96.2896C96.5939 23.7958 96.8429 24.0448 96.8429 24.3491C96.8429 28.1946 94.27 30.6015 90.4521 30.6015Z" fill="#000000" fillOpacity="0.6"/>
        <circle cx="79.5" cy="28.5" r="2" fill="#000000" fillOpacity="0.6"/>
        <path d="M70.9123 30.2696C70.608 30.2696 70.359 30.0206 70.359 29.7163V23.8511L64.9365 11.7059C64.7429 11.2909 65.0748 10.9036 65.4345 10.9036H67.8414C68.0904 10.9036 68.2564 11.0142 68.3671 11.3186L71.8253 19.3416C71.9083 19.5076 72.1573 19.5076 72.2403 19.3416L75.6708 11.3186C75.8092 11.0142 75.9475 10.9036 76.1965 10.9036H78.6034C78.9631 10.9036 79.295 11.2909 79.1014 11.7059L73.7066 23.8511V29.7163C73.7066 30.0206 73.4576 30.2696 73.1532 30.2696H70.9123Z" fill="#000000" fillOpacity="0.6"/>
        <path d="M53.3512 30.2696C53.0468 30.2696 52.7979 30.0206 52.7979 29.7163V11.4569C52.7979 11.1526 53.0468 10.9036 53.3512 10.9036H62.8129C63.1172 10.9036 63.3662 11.1526 63.3662 11.4569V13.6425C63.3662 13.9468 63.1172 14.1958 62.8129 14.1958H56.4221C56.2561 14.1958 56.1454 14.3065 56.1454 14.4724V18.4286C56.1454 18.5946 56.2561 18.7053 56.4221 18.7053H62.5639C62.8682 18.7053 63.1172 18.9543 63.1172 19.2586V21.4442C63.1172 21.7485 62.8682 21.9975 62.5639 21.9975H56.4221C56.2561 21.9975 56.1454 22.1082 56.1454 22.2742V26.7007C56.1454 26.8667 56.2561 26.9774 56.4221 26.9774H62.8959C63.2002 26.9774 63.4492 27.2264 63.4492 27.5307V29.7163C63.4492 30.0206 63.2002 30.2696 62.8959 30.2696H53.3512Z" fill="#000000" fillOpacity="0.6"/>
        <path d="M43.7632 30.2696C43.4589 30.2696 43.2099 30.0206 43.2099 29.7163V14.5278C43.2099 14.3618 43.0992 14.2511 42.9332 14.2511H39.2813C38.977 14.2511 38.728 14.0021 38.728 13.6978V11.4569C38.728 11.1526 38.977 10.9036 39.2813 10.9036H50.486C50.7903 10.9036 51.0393 11.1526 51.0393 11.4569V13.6978C51.0393 14.0021 50.7903 14.2511 50.486 14.2511H46.8341C46.6681 14.2511 46.5574 14.3618 46.5574 14.5278V29.7163C46.5574 30.0206 46.3084 30.2696 46.0041 30.2696H43.7632Z" fill="#000000" fillOpacity="0.6"/>
        <path d="M27.1432 30.2696C26.8388 30.2696 26.5898 30.0206 26.5898 29.7163V11.4569C26.5898 11.1526 26.8388 10.9036 27.1432 10.9036H36.6048C36.9092 10.9036 37.1582 11.1526 37.1582 11.4569V13.6425C37.1582 13.9468 36.9092 14.1958 36.6048 14.1958H30.2141C30.0481 14.1958 29.9374 14.3065 29.9374 14.4724V18.4286C29.9374 18.5946 30.0481 18.7053 30.2141 18.7053H36.3559C36.6602 18.7053 36.9092 18.9543 36.9092 19.2586V21.4442C36.9092 21.7485 36.6602 21.9975 36.3559 21.9975H30.2141C30.0481 21.9975 29.9374 22.1082 29.9374 22.2742V26.7007C29.9374 26.8667 30.0481 26.9774 30.2141 26.9774H36.6878C36.9922 26.9774 37.2412 27.2264 37.2412 27.5307V29.7163C37.2412 30.0206 36.9922 30.2696 36.6878 30.2696H27.1432Z" fill="#000000" fillOpacity="0.6"/>
        <path d="M14.004 30.2696C13.6997 30.2696 13.4507 30.0206 13.4507 29.7163V11.4569C13.4507 11.1526 13.6997 10.9036 14.004 10.9036H19.6201C23.0507 10.9036 25.5406 13.4211 25.5406 16.8794C25.5406 20.3099 23.0507 22.8552 19.6201 22.8552H17.0749C16.9089 22.8552 16.7982 22.9658 16.7982 23.1318V29.7163C16.7982 30.0206 16.5492 30.2696 16.2449 30.2696H14.004ZM16.7982 19.2863C16.7982 19.4523 16.9089 19.5629 17.0749 19.5629H19.5925C21.0034 19.5629 22.0824 18.3733 22.0824 16.8794C22.0824 15.3854 21.0034 14.1958 19.5925 14.1958H17.0749C16.9089 14.1958 16.7982 14.3065 16.7982 14.4724V19.2863Z" fill="#000000" fillOpacity="0.6"/>
        <path d="M5.09375 33.4473C6.23509 35.2759 7.92917 36.7364 9.96387 37.6172C10.8672 38.0082 12.0211 38.2619 13.9258 38.3965C15.8597 38.5331 18.3275 38.5352 21.8301 38.5352H101.727C105.229 38.5352 107.698 38.5331 109.632 38.3965C111.536 38.2619 112.69 38.0081 113.593 37.6172C115.135 36.9495 116.483 35.9487 117.542 34.707H121.141C119.689 37.1393 117.478 39.0816 114.806 40.2383L114.55 40.3438C111.886 41.4061 108.429 41.4062 101.727 41.4062H21.8301C15.1273 41.4062 11.6709 41.4062 9.00684 40.3438L8.75195 40.2383C5.76384 38.9449 3.35157 36.6694 1.93359 33.8242L5.09375 33.4473ZM3.52832 18.4355C3.52585 19.174 3.52539 19.9689 3.52539 20.8281C3.52539 24.2165 3.5277 26.6038 3.66895 28.4746C3.7369 29.3745 3.83395 30.1013 3.96289 30.7109L1.01172 31.0625C0.559395 28.7375 0.556641 25.6523 0.556641 20.8281C0.556641 19.9785 0.558068 19.1827 0.560547 18.4355H3.52832ZM122.58 10.7783C122.998 13.0818 122.999 16.1306 122.999 20.8281C122.999 22.4476 122.999 23.8711 122.981 25.1357H120.014C120.031 23.9013 120.031 22.4843 120.031 20.8281C120.031 17.4397 120.029 15.0524 119.888 13.1816C119.813 12.1979 119.702 11.4215 119.555 10.7783H122.58ZM101.727 0.25C108.646 0.25 112.106 0.249299 114.806 1.41797C117.82 2.72271 120.246 5.02709 121.659 7.90723H118.267C117.131 6.21993 115.514 4.87073 113.593 4.03906C112.69 3.64813 111.536 3.39435 109.632 3.25977C107.698 3.12312 105.229 3.12109 101.727 3.12109H21.8301C18.3275 3.12109 15.8597 3.12315 13.9258 3.25977C12.0211 3.39436 10.8672 3.64808 9.96387 4.03906C7.81312 4.97004 6.04116 6.54765 4.90234 8.52441L1.69434 8.33301L1.76465 8.17676C3.06859 5.35796 5.33634 3.06656 8.17578 1.68262L8.75195 1.41797C11.4518 0.249511 14.9115 0.25 21.8301 0.25H101.727Z" fill="#000000" fillOpacity="0.6"/>
        <rect x="119" y="28.3281" width="4" height="4" rx="2" fill="#000000" fillOpacity="0.6"/>
        <rect y="11.3281" width="4" height="4" rx="2" fill="#000000" fillOpacity="0.6"/>
      </svg>
    </motion.div>
  )
}
